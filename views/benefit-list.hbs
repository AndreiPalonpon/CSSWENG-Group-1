<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LPPWDFI | Equipment List</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/css/List-style.css">
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
</head>

<body>
    <!-- Need to Edit this file -->
    <div id="wrapper">
        <div class="overlay dark_bg"></div>
        <!-- Modal Background -->

         <!-- Sidebar -->
        <nav class="navbar navbar-inverse fixed-top" id="sidebar-wrapper" role="navigation">
            <ul class="nav sidebar-nav">
                <div class="sidebar-header">
                    <div class="sidebar-brand">
                        <a href="#">Admin</a>
                        <hr class="navbar-solid">
                    </div>
                </div>
                <li><a href="/">Dashboard</a></li>
                <li><a href="/programs">Programs</a></li>
                <li><a href="/people">People</a></li>
                <li><a href="/benefactors">Benefactor</a></li>
                <li><a href="/benefits">Benefits</a></li>
                <li><a href="/settings">Settings</a></li>
                <li class="logout-link">
                    <form action="/logout" method="POST">
                        <button type="submit" class="btn btn-link logout-btn">
                            <i class="bi bi-box-arrow-right"></i> 
                            Logout
                        </button>
                    </form>
                </li>
            </ul>
        </nav>
        <!-- /#sidebar-wrapper -->

        <!-- HEADER -->
        <div class="bg-half-gradient">
            <header class="bg-gradient">
                <div class="container d-flex align-items-center">
                    <div class="menu-icon mr-3" id="menu-toggle">&#9776;</div>
                    <a href="../views/dashboard.html">
                        <img src="../images/LPPWDFI-Logo.png" alt="Logo" class="logo mr-3">
                    </a>
                    <div>
                        <h1 class="org-name">Benefits</h1>
                    </div>
                </div>

                <div class="createBtn">
                    <button type="button" data-bs-toggle="modal" data-bs-target="#modal-benefit-create">Create</button>
                </div>
            </header>
        </div>


        <!--2nd Header-->
        <main class="main-content">
            <h2 class="main-title">Benefit List</h2>
            <div class="button-group">
                <button class="btn export-btn" onclick="exportTableToCSV('Benefits.csv')">Export to CSV</button> <!--CHANGE-->
            </div>

            <!---TABLE LISTS-->
            <div class="table-container">
                <button id="resetFiltersButton" class="btn btn-secondary">Reset Filters</button>
                <table class="table table-bordered table-hover">
                    <caption>List of Benefits</caption>
                    <thead class="thead-light">
                       <tr>
                                <th scope="col">#</th>
                                <th scope="col">
                                    <div class="dropdown">
                                        <a class="dropdown-toggle" id="nameDropdown" data-bs-toggle="dropdown" aria-expanded="false">Name</a>
                                        <ul class="dropdown-menu" aria-labelledby="nameDropdown">
                                            <li>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="nameSort" value="az" id="nameSortAZ">
                                                    <label class="form-check-label" for="nameSortAZ">A-Z</label>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="nameSort" value="za" id="nameSortZA">
                                                    <label class="form-check-label" for="nameSortZA">Z-A</label>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </th>
                                <th scope="col">Description</th>
                                <th scope="col">
                                    <div class="dropdown">
                                        <a class="dropdown-toggle" id="quantityDropdown" data-bs-toggle="dropdown" aria-expanded="false">Quantity</a>
                                        <ul class="dropdown-menu" aria-labelledby="quantityDropdown">
                                            <li>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="quantitySort" value="asc" id="quantitySortAsc">
                                                    <label class="form-check-label" for="quantitySortAsc">Ascending</label>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="quantitySort" value="desc" id="quantitySortDesc">
                                                    <label class="form-check-label" for="quantitySortDesc">Descending</label>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </th>
                                <th scope="col">
                                    <div class="dropdown">
                                        <a class="dropdown-toggle" id="dateReceivedDropdown" data-bs-toggle="dropdown" aria-expanded="false">Date Received</a>
                                        <ul class="dropdown-menu" aria-labelledby="dateReceivedDropdown">
                                            <li>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="dateSort" value="newest" id="dateSortNewest">
                                                    <label class="form-check-label" for="dateSortNewest">Newest</label>
                                                </div>
                                            </li>
                                            <li>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="radio" name="dateSort" value="oldest" id="dateSortOldest">
                                                    <label class="form-check-label" for="dateSortOldest">Oldest</label>
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                </th>
                                <th scope="col">Benefactor</th>
                                <th scope="col">Actions</th>
                            </tr>
                    </thead>
                    <tbody class="programInfo">
                        <!-- Program rows will be populated here -->
                        {{#each benefits}}
                        <tr data-benefit-id="{{this.id}}">
                            <th scope="row">{{incremented @index}}</th>
                            <td>{{this.name}}</td>
                            <td>{{this.description}}</td>
                            <td>{{this.quantity}}</td>
                            <td>{{formatDate this.date_received}}</td>
                            <td>{{this.benefactor.name}}</td>
                            <td>
                                <button class="editBtn" data-bs-toggle="modal" data-bs-target="#modal-benefit-edit"><i class="bi bi-pencil"></i></button>
                                <button class="deleteBtn" data-id="{{this._id}}"><i class="bi bi-trash"></i></button>
                            </td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        </main>

        <nav aria-label="page-navigation">
            <ul class="pagination">
                <!-- Pagination items will be dynamically added here -->
            </ul>
        </nav>

        <!-- Create Benefit Modal -->
        <div class="modal fade" id="modal-benefit-create">
            <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">Create a Benefit</h2>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="createBenefitForm" action="/benefits/create" method="POST">
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <label for="benefitName">Benefit Name</label>
                                    <input type="text" class="form-control" id="benefitName" name="benefitName" placeholder="Benefit Name" required>
                                </div>

                                <div class="form-group col-md-6">
                                    <label for="benefitDesc">Benefit Description</label>
                                    <input type="text" class="form-control" id="benefitDesc" name="benefitDesc" placeholder="Benefit Description" required>
                                </div>

                                <div class="form-group col-md-6">
                                    <label for="quantity">Quantity</label>
                                    <input type="text" class="form-control" id="quantity" name="quantity" placeholder="Quantity" required>
                                </div>

                                <div class="form-group col-md-6">
                                    <label for="dateReceived">Date Received</label>
                                    <input type="date" class="form-control" id="dateReceived" name="dateReceived" required>
                                </div>

                                <div class="form-group col-md-6">
                                    <label for="benefactor">Benefactor</label>
                                    <select class="form-control" id="benefactor" name="benefactor" required>
                                        <option value="" selected disabled>Choose...</option>
                                        {{#each benefactors}}
                                            <option value="{{this._id}}">{{this.name}}</option>
                                        {{/each}}
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="submitBtn" form="createBenefitForm">Submit</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit Benefit Modal -->
        <div class="modal fade" id="modal-benefit-edit" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title" id="editBenefitModalLabel">Edit Benefit</h2>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="editBenefitForm" action="/benefits/edit" method="POST">
                            <input type="hidden" id="editBenefitId" name="id">
                            <div class="row">
                                <div class="form-group col-md-6">
                                    <label for="editBenefitName" class="form-label">Benefit Name</label>
                                    <input type="text" class="form-control" id="editBenefitName" name="benefitName" required>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="editBenefitDesc" class="form-label">Benefit Description</label>
                                    <input type="text" class="form-control" id="editBenefitDesc" name="benefitDesc" required>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="editQuantity" class="form-label">Quantity</label>
                                    <input type="text" class="form-control" id="editQuantity" name="quantity" required>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="editDateReceived" class="form-label">Date Received</label>
                                    <input type="date" class="form-control" id="editDateReceived" name="dateReceived" required>
                                </div>
                                <div class="form-group col-md-6">
                                    <label for="editBenefactor" class="form-label">Benefactor</label>
                                    <select class="form-control" id="editBenefactor" name="benefactor" required>
                                        <option value="" selected disabled>Choose...</option>
                                        {{#each benefactors}}
                                            <option value="{{this._id}}">{{this.name}}</option>
                                        {{/each}}
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="submit" class="submitBtn" form="editBenefitForm">Update</button>
                    </div>
                </div>
            </div>
        </div>



        <!-- JQuery -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <!-- External JS -->
        <script src="/js/benefit-list.js"></script>
    </div>
</body>

</html>
