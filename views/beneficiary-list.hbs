<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LPPWDFI | Beneficiaries List</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/css/List-style.css">
</head>

<body>
    <div id="wrapper">
        <div class="overlay dark_bg"></div>
        <!-- Modal Background -->

         <!-- Sidebar -->
        <nav class="navbar navbar-inverse fixed-top" id="sidebar-wrapper" role="navigation">
            <ul class="nav sidebar-nav">
                <div class="sidebar-header">
                    <div class="sidebar-brand">
                        <a href="#">Admin</a>
                        <hr class="navbar-solid">
                    </div>
                </div>
                <li><a href="/">Dashboard</a></li>
                <li><a href="/programs">Programs</a></li>
                <li><a href="/people">People</a></li>
                <li><a href="/benefactors">Benefactor</a></li>
                <li><a href="/benefits">Benefits</a></li>
                <li><a href="/settings">Settings</a></li>
                <li class="logout-link">
                    <form action="/logout" method="POST">
                        <button type="submit" class="btn btn-link logout-btn">
                            <i class="bi bi-box-arrow-right"></i> 
                            Logout
                        </button>
                    </form>
                </li>
            </ul>
        </nav>
        <!-- /#sidebar-wrapper -->

        <!-- HEADER -->
        <div class="bg-half-gradient">
            <header class="bg-gradient">
                <div class="container d-flex align-items-center">
                    <div class="menu-icon mr-3" id="menu-toggle">&#9776;</div>
                    <a href="../views/dashboard.html">
                        <img src="../images/LPPWDFI-Logo.png" alt="Logo" class="logo mr-3">
                    </a>
                    <div>
                        <h1 class="org-name">Beneficiary</h1>
                    </div>
                </div>

                <div class="createBtn">
                    <button type="button" data-bs-toggle="modal" data-bs-target="#modal-benefactor-create">Create</button>
                </div>
            </header>
        </div>

        <!--MODAL FORM-->
        <div class="popup">
            <header>
                <h2 class="modalTitle">Fill the Form</h2>
                <span class="closeBtn">&times;</span>
            </header>
            <form id="createBeneficiaryForm" action="/beneficiaries/create" method="POST">
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="personRegistered">Person Registered</label>
                        <select class="form-control" id="personRegistered" name="personRegistered" required>
                            <option value="" selected disabled>Choose...</option>
                            {{#each people}}
                            <option value="{{this._id}}">{{this.name}}</option>
                            {{/each}}
                        </select>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="programEnrolled">Program Enrolled</label>
                            <!-- Hidden input to hold the program ID -->
                                <input type="hidden" id="programEnrolled" name="programEnrolled" value="{{program._id}}">
                            <!-- Visible, disabled input to display the program name -->
                                <input type="text" class="form-control" value="{{program.name}}" readonly>

                    </div>

                     <div class="form-group col-md-6">
                        <label for="status">Status</label>
                        <select class="form-control" id="status" name="status" required>
                            <option value="" selected disabled>Choose...</option>
                            <!-- Not final. The options can be changed. -->
                            <option value="Active">Active</option>
                            <option value="Suspended">Suspended</option>
                            <option value="Terminated">Terminated</option>
                        </select>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="benefitDelivered">Benefit Delivered</label>
                        <select class="form-control" id="benefitDelivered" name="benefitDelivered" required>
                            <option value="" selected disabled>Choose...</option>
                            {{#each benefits}}
                            <option value="{{this._id}}">{{this.name}}</option>
                            {{/each}}
                        </select>
                    </div>

                    <div class="form-group col-md-6">
                        <label for="date_received">Date Received</label>
                        <input type="date" class="form-control" id="date_received" name="date_received" placeholder="Date" required>
                    </div>
                </div>
                <input type="submit" class="submitBtn" value="Submit">
            </form>
        </div>

        <!--2nd Header-->
        <main class="main-content">
            <h2 class="main-title">Beneficiaries for <a href="/documentation/{{program._id}}">{{program.name}}</a></h2>

            <div class="button-group">
                <button class="btn export-btn" onclick="exportTableToCSV('Beneficiaries.csv')">Export to CSV</button>
            </div>

            <!---TABLE LISTS-->
            <div class="table-container">
                <form id="filter-form">
                <button id="resetFiltersButton" class="btn btn-secondary">Reset Filters</button>
                <table class="table table-bordered table-hover">
                    <caption>List of Beneficiaries</caption>
                    <thead class="thead-light">
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="recipientDropdown" data-bs-toggle="dropdown" aria-expanded="false">Recipient</a>
                                    <ul class="dropdown-menu" aria-labelledby="recipientDropdown">
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="recipientSort" value="az" id="recipientSortAZ">
                                                <label class="form-check-label" for="recipientSortAZ">A-Z</label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="recipientSort" value="za" id="recipientSortZA">
                                                <label class="form-check-label" for="recipientSortZA">Z-A</label>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">Program Enrolled</th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="statusDropdown" data-bs-toggle="dropdown" aria-expanded="false">Status</a>
                                    <ul class="dropdown-menu" aria-labelledby="statusDropdown">
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Active" id="activeStatus" name="statusFilter">
                                                <label class="form-check-label" for="activeStatus">Active</label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Terminated" id="terminatedStatus" name="statusFilter">
                                                <label class="form-check-label" for="terminatedStatus">Terminated</label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Suspended" id="suspendedStatus" name="statusFilter">
                                                <label class="form-check-label" for="suspendedStatus">Suspended</label>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="benefitDropdown" data-bs-toggle="dropdown" aria-expanded="false">Benefit</a>
                                    <ul class="dropdown-menu" aria-labelledby="benefitDropdown">
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="benefitSort" value="az" id="benefitSortAZ">
                                                <label class="form-check-label" for="benefitSortAZ">A-Z</label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="benefitSort" value="za" id="benefitSortZA">
                                                <label class="form-check-label" for="benefitSortZA">Z-A</label>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="dateDropdown" data-bs-toggle="dropdown" aria-expanded="false">Date Received</a>
                                    <ul class="dropdown-menu" aria-labelledby="dateDropdown">
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="dateSort" value="newest" id="dateSortNewest">
                                                <label class="form-check-label" for="dateSortNewest">Newest</label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="dateSort" value="oldest" id="dateSortOldest">
                                                <label class="form-check-label" for="dateSortOldest">Oldest</label>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="programInfo">
                        <!-- Program rows will be populated here -->
                        {{#each beneficiaries}}
                        <tr>
                            <th scope="row">{{incremented @index}}</th>
                            <td>{{this.person_registered.name}}</td>
                            <td>{{this.program_enrolled.name}}</td>
                            <td>{{this.status}}</td>
                            <td>{{this.benefit_delivered.name}}</td>
                            <td>{{formatDate this.date_received}}</td>
                            <td>
                                <button class="editBtn" data-id="{{this._id}}"><i class="bi bi-pencil"></i></button>
                                <button class="deleteBtn" data-id="{{this._id}}"><i class="bi bi-trash"></i></button>
                            </td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
                </form>
            </div>
        </main>

        <nav aria-label="page-navigation">
            <ul class="pagination">
                <!-- Pagination items will be dynamically added here -->
            </ul>
        </nav>

        <!-- JQuery -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <!-- External JS -->
        <script src="/js/beneficiary-list.js"></script>
</body>

</html>
