<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LPPWDFI | People Lists</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="/css/program-list-style.css">
    <script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
</head>

<body>
    <div id="wrapper">
        <div class="overlay dark_bg"></div>
        <!-- Modal Background -->

        <!-- Sidebar -->
        <nav class="navbar navbar-inverse fixed-top" id="sidebar-wrapper" role="navigation">
            <ul class="nav sidebar-nav">
                <div class="sidebar-header">
                    <div class="sidebar-brand">
                        <a href="#">Admin</a>
                        <hr class="navbar-solid">
                    </div>
                </div>
                <li><a href="/">Dashboard</a></li>
                <li><a href="/programs">Programs</a></li>
                <li><a href="/beneficiaries">Beneficiary</a></li>
                <li><a href="/benefactors">Benefactor</a></li>
                <li><a href="/benefits">Benefits</a></li>
                <li><a href="/settings">Settings</a></li>
                <li class="logout-link"><a href="#logout"><i class="bi bi-box-arrow-right"></i> Logout</a></li>
            </ul>
        </nav>
        <!-- /#sidebar-wrapper -->

        <!-- HEADER -->
        <div class="bg-half-gradient">
            <header class="bg-gradient">
                <div class="container d-flex align-items-center">
                    <div class="menu-icon mr-3" id="menu-toggle">&#9776;</div>
                    <a href="../views/dashboard.html">
                        <img src="../images/LPPWDFI-Logo.png" alt="Logo" class="logo mr-3">
                    </a>
                    <div>
                        <h1 class="org-name">People</h1>
                    </div>
                </div>

                <div class="addPeopleBtn">
                    <button>Create</button>
                </div>

            </header>
        </div>

        <!--MODAL FORM-->
        <div class="popup">
            <header>
                <h2 class="modalTitle">Fill the Form</h2>
                <span class="closeBtn">&times;</span>
            </header>
            <form id="peopleForm" action="/people/create" method="POST">
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="firstName">First Name</label>
                        <input type="text" class="form-control" id="firstName" name="first_name" placeholder="First Name" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="lastName">Last Name</label>
                        <input type="text" class="form-control" id="lastName" name="last_name" placeholder="Last Name" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="gender">Gender</label>
                        <select id="gender" name="gender" class="form-control" required>
                            <option value="" selected disabled>Choose...</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="birthdate">Birthdate</label>
                        <input type="date" id="birthdate" name="birthdate" class="form-control" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="address">Address</label>
                        <input type="text" class="form-control" id="address" name="address" placeholder="Address" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="barangay">Barangay</label>
                        <select id="barangay" name="barangay" class="form-control" required>
                            <option value="" selected disabled>Choose...</option>
                            {{#each barangayCodes}}
                                <option value="{{this}}">{{this}}</option>
                            {{/each}}
                        </select>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="contactNumber">Contact Number</label>
                        <input type="text" class="form-control" id="contactNumber" name="contact_number" placeholder="Contact Number" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="disabilityType">Disability Type</label>
                        <select id="disabilityType" name="disability_type" class="form-control" required>
                            <option value="" selected disabled>Choose...</option>
                            <option value="Physical">Physical</option>
                            <option value="Sensory">Sensory</option>
                            <option value="Intellectual">Intellectual</option>
                            <option value="Mental">Mental</option>
                        </select>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="disability">Disability</label>
                        <input type="text" class="form-control" id="disability" name="disability" placeholder="Disability" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="pwdCardIdNo">PWD Card ID No.</label>
                        <input class="form-control" id="pwdCardIdNo" name="pwd_card_id_no" placeholder="PWD Card ID No." required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="recentPwdIdUpdateDate">Recent PWD ID Update Date</label>
                        <input type="date" id="recentPwdIdUpdateDate" name="recent_pwd_id_update_date" class="form-control" required>
                    </div>
                </div>
                <input type="submit" class="submitPeopleBtn" value="Submit">
            </form>
        </div>
        <!--2nd Header-->
        <main class="main-content">
            <h2 class="main-title">People List</h2>
            <div class="button-group">
                <button class="btn export-btn" onclick="exportTableToCSV('People.csv')">Export to CSV</button>
            </div>

            <!---TABLE LISTS-->
            <div class="table-container">
                <button id="resetFiltersButton" class="btn btn-secondary">Reset Filters</button>
                <table class="table table-bordered table-hover" style="font-size: 0.70rem;">
                    <caption>List of People</caption>
                    <thead class="thead-light">
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="firstNameDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        First Name
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="firstNameDropdown">
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="firstNameSort" value="az" id="firstNameSortAZ">
                                                <label class="form-check-label" for="firstNameSortAZ">
                                                    A-Z
                                                </label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="firstNameSort" value="za" id="firstNameSortZA">
                                                <label class="form-check-label" for="firstNameSortZA">
                                                    Z-A
                                                </label>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="lastNameDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Last Name
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="lastNameDropdown">
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="lastNameSort" value="az" id="lastNameSortAZ">
                                                <label class="form-check-label" for="lastNameSortAZ">
                                                    A-Z
                                                </label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="lastNameSort" value="za" id="lastNameSortZA">
                                                <label class="form-check-label" for="lastNameSortZA">
                                                    Z-A
                                                </label>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="genderDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Gender
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="genderDropdown">
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Male" id="maleCheck" name="genderFilter">
                                                <label class="form-check-label" for="maleCheck">
                                                    Male
                                                </label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Female" id="femaleCheck" name="genderFilter">
                                                <label class="form-check-label" for="femaleCheck">
                                                    Female
                                                </label>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="birthdateDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Birthdate
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="birthdateDropdown">
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="birthdateSort" value="newest" id="birthdateSortNewest">
                                                <label class="form-check-label" for="birthdateSortNewest">
                                                    Newest
                                                </label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="birthdateSort" value="oldest" id="birthdateSortOldest">
                                                <label class="form-check-label" for="birthdateSortOldest">
                                                    Oldest
                                                </label>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </th>
                                                        <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="addressDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Address
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="addressDropdown">
                                        <!-- Add address filtering options if needed -->
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="barangayDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Barangay
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="barangayDropdown">
                                        {{#each barangayCodes}}
                                            <li>
                                                <div class="form-check">
                                                    <input class="form-check-input" type="checkbox" value="{{this}}" id="{{@key}}Check" name="barangayFilter">
                                                    <label class="form-check-label" for="{{@key}}Check">
                                                        {{this}}
                                                    </label>
                                                </div>
                                            </li>
                                        {{/each}}
                                    </ul>
                                </div>
                            </th>

                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="contactNumberDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Contact Number
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="contactNumberDropdown">
                                        <!-- Add contact number filtering options if needed -->
                                    </ul>
                                </div>
                            </th>

                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="disabilityTypeDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Disability Type
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="disabilityTypeDropdown">
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Physical" id="physicalCheck" name="disabilityTypeFilter">
                                                <label class="form-check-label" for="physicalCheck">
                                                    Physical
                                                </label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Sensory" id="sensoryCheck" name="disabilityTypeFilter">
                                                <label class="form-check-label" for="sensoryCheck">
                                                    Sensory
                                                </label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Intellectual" id="intellectualCheck" name="disabilityTypeFilter">
                                                <label class="form-check-label" for="intellectualCheck">
                                                    Intellectual
                                                </label>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" value="Mental" id="mentalCheck" name="disabilityTypeFilter">
                                                <label class="form-check-label" for="mentalCheck">
                                                    Mental
                                                </label>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="disabilityDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Disability
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="disabilityDropdown">
                                        <!-- Add disability filtering options if needed -->
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="pwdCardIdNoDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        PWD Card ID No.
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="pwdCardIdNoDropdown">
                                        <!-- Add PWD Card ID No. filtering options if needed -->
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">
                                <div class="dropdown">
                                    <a class="dropdown-toggle" id="recentPwdIdUpdateDateDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        Recent PWD ID Date
                                    </a>
                                    <ul class="dropdown-menu" aria-labelledby="recentPwdIdUpdateDateDropdown">
                                        <!-- Add recent PWD ID date filtering options if needed -->
                                    </ul>
                                </div>
                            </th>
                            <th scope="col">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Table rows go here -->
                        {{#each people}}
                        <tr>
                            <td>{{incremented @index}}</td>
                            <td>{{this.first_name}}</td>
                            <td>{{this.last_name}}</td>
                            <td>{{this.gender}}</td>
                            <td>{{this.birthdate}}</td>
                            <td>{{this.address}}</td>
                            <td>{{this.barangay}}</td>
                            <td>{{this.contact_number}}</td>
                            <td>{{this.disability_type}}</td>
                            <td>{{this.disability}}</td>
                            <td>{{this.pwd_card_id_no}}</td>
                            <td>{{this.recent_pwd_id_update_date}}</td>
                            <td>
                                <button class="editBtn" data-id="{{this._id}}"><i class="bi bi-pencil"></i></button>
                                <button class="deleteBtn" data-id="{{this._id}}"><i class="bi bi-trash"></i></button>
                            </td>
                        </tr>
                        {{/each}}

                    </tbody>
                </table>
            </div>
        </main>

        <nav aria-label="page-navigation">
            <ul class="pagination">
                <!-- Pagination items will be dynamically added here -->
            </ul>
        </nav>

        <!-- JQuery -->
        <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                document.getElementById("menu-toggle").addEventListener("click", function() {
                    document.getElementById("wrapper").classList.toggle("toggled");
                    document.querySelector(".main-content").classList.toggle("toggled");
                    document.querySelector(".header-right").classList.toggle("toggled");
                });

                $(document).ready(function() {
                    $("#myInput").on("keyup", function() {
                        var value = $(this).val().toLowerCase();
                        $(".dropdown-menu li").filter(function() {
                            $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
                        });
                    });
                });

                var newMemberAddBtn = document.querySelector('.addPeopleBtn button'),
                    darkBg = document.querySelector('.dark_bg'),
                    popupForm = document.querySelector('.popup'),
                    crossBtn = document.querySelector('.closeBtn'),
                    submitPeopleBtn = document.querySelector('.submitPeopleBtn'),
                    modalTitle = document.querySelector('.modalTitle'),
                    form = document.querySelector('#peopleForm'),
                    formInputFields = document.querySelectorAll('#peopleForm input, #peopleForm select'),
                    peopleInfo = document.querySelector('.peopleInfo'),
                    resetFiltersButton = document.getElementById('resetFiltersButton');

                let originalData = localStorage.getItem('people') ? JSON.parse(localStorage.getItem('people')) : [];
                let getData = [...originalData];

                let isEdit = false,
                    editId;

                newMemberAddBtn.addEventListener('click', () => {
                    isEdit = false;
                    submitPeopleBtn.innerHTML = "Submit";
                    modalTitle.innerHTML = "Fill the Form";
                    form.reset();
                    formInputFields.forEach(input => input.disabled = false);
                    submitPeopleBtn.style.display = "block";
                    darkBg.classList.add('active');
                    popupForm.classList.add('active');
                });

                crossBtn.addEventListener('click', () => {
                    darkBg.classList.remove('active');
                    popupForm.classList.remove('active');
                    form.reset();
                    submitPeopleBtn.style.display = "block";
                    formInputFields.forEach(input => input.disabled = false);
                });

                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    const person = {
                        id: Date.now(),
                        first_name: form.first_name.value,
                        last_name: form.last_name.value,
                        gender: form.gender.value,
                        birthdate: form.birthdate.value,
                        address: form.address.value,
                        barangay: form.barangay.value,
                        contact_number: form.contact_number.value,
                        disability_type: form.disability_type.value,
                        disability: form.disability.value,
                        pwd_card_id_no: form.pwd_card_id_no.value,
                        recent_pwd_id_update_date: form.recent_pwd_id_update_date.value
                    };

                    if (!isEdit) {
                        originalData.push(person);
                    } else {
                        originalData[editId] = person;
                    }

                    localStorage.setItem('people', JSON.stringify(originalData));
                    getData = [...originalData];
                    showInfo();
                    darkBg.classList.remove('active');
                    popupForm.classList.remove('active');
                    form.reset();
                });

                function showInfo() {
                    displayRows(getData, currentPage);
                    displayPagination(getData.length);
                    addEventListeners();
                }

                let currentPage = 1;
                const rowsPerPage = 5;

                function displayPagination(totalRows) {
                    const pagination = document.querySelector('.pagination');
                    const totalPages = Math.ceil(totalRows / rowsPerPage);

                    pagination.innerHTML = `
                         <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                             <a class="page-link" href="#" aria-label="Previous" id="prevButton">
                                 <span aria-hidden="true">&laquo;</span>
                             </a>
                         </li>
                         `;

                    for (let i = 1; i <= totalPages; i++) {
                        pagination.innerHTML += `
                         <li class="page-item ${currentPage === i ? 'active' : ''}">
                             <a class="page-link paginationButton" href="#">${i}</a>
                         </li>
                         `;
                    }

                    pagination.innerHTML += `
                     <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                         <a class="page-link" href="#" aria-label="Next" id="nextButton">
                             <span aria-hidden="true">&raquo;</span>
                         </a>
                     </li>
                     `;

                    document.getElementById("prevButton").addEventListener("click", prevPage);
                    document.getElementById("nextButton").addEventListener("click", nextPage);

                    const paginationButtons = document.getElementsByClassName("paginationButton");
                    for (let i = 0; i < paginationButtons.length; i++) {
                        paginationButtons[i].addEventListener("click", function(event) {
                            event.preventDefault();
                            goToPage(parseInt(this.textContent));
                        });
                    }
                }

                function displayRows(rows, page = 1) {
                    const start = (page - 1) * rowsPerPage;
                    const end = start + rowsPerPage;
                    const paginatedRows = rows.slice(start, end);
                    const peopleInfo = document.querySelector('.peopleInfo');
                    peopleInfo.innerHTML = '';
                    paginatedRows.forEach((people, index) => {
                        const row = `
                             <tr>
                                 <td>${start + index + 1}</td>
                                 <td>${capitalizeFirstLetter(people.first_name)}</td>
                                 <td>${capitalizeFirstLetter(people.last_name)}</td>
                                 <td>${people.gender}</td>
                                 <td>${people.birthdate}</td>
                                 <td>${people.address}</td>
                                 <td>${people.barangay}</td>
                                 <td>${people.contact_number}</td>
                                 <td>${people.disability_type}</td>
                                 <td>${people.disability}</td>
                                 <td>${people.pwd_card_id_no}</td>
                                 <td>${people.recent_pwd_id_update_date}</td>
                                 <td>
                                     <button class="editBtn" data-id="${people.id}"><i class="bi bi-pencil"></i></button>
                                     <button class="deleteBtn" data-id="${people.id}"><i class="bi bi-trash"></i></button>
                                 </td>
                             </tr>
                             `;
                        peopleInfo.innerHTML += row;
                    });

                    function capitalizeFirstLetter(string) {
                        return string.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()).join(' ');
                    }
                }

                function addEventListeners() {
                    // Event listeners for sorting and filtering
                    document.querySelectorAll('input[name="firstNameSort"], input[name="lastNameSort"], input[name="birthdateSort"]').forEach(radio => {
                        radio.addEventListener('change', () => {
                            sortData();
                            displayRows(getData, currentPage);
                            displayPagination(getData.length);
                        });
                    });
                    document.querySelectorAll('input[name="genderFilter"], input[name="barangayFilter"], input[name="disabilityTypeFilter"]').forEach(checkbox => {
                        checkbox.addEventListener('change', () => {
                            filterData();
                            displayRows(getData, currentPage);
                            displayPagination(getData.length);
                        });
                    });
                }

                function prevPage(event) {
                    event.preventDefault();
                    if (currentPage > 1) {
                        currentPage--;
                        displayRows(getData, currentPage);
                        displayPagination(getData.length);
                    }
                }

                function nextPage(event) {
                    event.preventDefault();
                    const totalPages = Math.ceil(getData.length / rowsPerPage);
                    if (currentPage < totalPages) {
                        currentPage++;
                        displayRows(getData, currentPage);
                        displayPagination(getData.length);
                    }
                }

                function goToPage(page) {
                    currentPage = page;
                    displayRows(getData, currentPage);
                    displayPagination(getData.length);
                }

                function sortData() {
                    const selectedFirstNameSort = document.querySelector('input[name="firstNameSort"]:checked') ? document.querySelector('input[name="firstNameSort"]:checked').value : null;
                    const selectedLastNameSort = document.querySelector('input[name="lastNameSort"]:checked') ? document.querySelector('input[name="lastNameSort"]:checked').value : null;
                    const selectedBirthdateSort = document.querySelector('input[name="birthdateSort"]:checked') ? document.querySelector('input[name="birthdateSort"]:checked').value : null;

                    getData.sort((a, b) => {
                        // Sort by First Name 
                        if (selectedFirstNameSort) {
                            if (selectedFirstNameSort === 'az') {
                                return a.first_name.localeCompare(b.first_name);
                            } else {
                                return b.first_name.localeCompare(a.first_name);
                            }
                        }

                        // Sort by Last Name 
                        if (selectedLastNameSort) {
                            if (selectedLastNameSort === 'az') {
                                return a.last_name.localeCompare(b.last_name);
                            } else {
                                return b.last_name.localeCompare(a.last_name);
                            }
                        }

                        // Sort by Birthdate
                        if (selectedBirthdateSort) {
                            if (selectedBirthdateSort === 'newest') {
                                return new Date(b.birthdate) - new Date(a.birthdate);
                            } else {
                                return new Date(a.birthdate) - new Date(b.birthdate);
                            }
                        }
                    });
                    showInfo();
                }

                function filterData() {
                    let filteredData = [...originalData];
                    const selectedGender = Array.from(document.querySelectorAll('input[name="genderFilter"]:checked')).map(check => check.value);
                    if (selectedGender.length > 0) {
                        filteredData = filteredData.filter(person => selectedGender.includes(person.gender));
                    }

                    const selectedBarangay = Array.from(document.querySelectorAll('input[name="barangayFilter"]:checked')).map(check => check.value);
                    if (selectedBarangay.length > 0) {
                        filteredData = filteredData.filter(person => selectedBarangay.includes(person.barangay));
                    }

                    const selectedDisabilityType = Array.from(document.querySelectorAll('input[name="disabilityTypeFilter"]:checked')).map(check => check.value);
                    if (selectedDisabilityType.length > 0) {
                        filteredData = filteredData.filter(person => selectedDisabilityType.includes(person.disability_type));
                    }

                    getData = filteredData;
                    showInfo();
                }

                resetFiltersButton.addEventListener('click', () => {
                    document.querySelectorAll('input[type="checkbox"], input[type="radio"]').forEach(input => {
                        input.checked = false;
                    });
                    getData = [...originalData];
                    showInfo();
                });

                displayRows(getData, currentPage);
                displayPagination(getData.length);
                addEventListeners();
            });

            /* Exporting to CSV function */
            function downloadCSV(csv, filename) {
                let csvFile;
                let downloadLink;
                csvFile = new Blob([csv], {
                    type: 'text/csv'
                });

                downloadLink = document.createElement('a');
                downloadLink.download = filename;
                downloadLink.href = window.URL.createObjectURL(csvFile);
                downloadLink.style.display = 'none';
                document.body.appendChild(downloadLink);
                downloadLink.click();
            }

            function exportTableToCSV(filename) {
                const rows = document.querySelectorAll('.table-container table tr');
                let csv = [];
                for (let i = 0; i < rows.length; i++) {
                    const row = [],
                        cols = rows[i].querySelectorAll('td, th');
                    for (let j = 0; j < cols.length; j++) {
                        const data = cols[j].innerText.replace(/(\r\n|\n|\r)/gm, '').replace(/(\s\s)/gm, ' ');
                        row.push('"' + data + '"');
                    }
                    csv.push(row.join(','));
                }
                downloadCSV(csv.join('\n'), filename);
            }
        </script>
    </div>
</body>

</html>